# wamquery

This repository contains a collection of runtime primitives for implementing an
SQL-like query language.

For example, it includes:

- primitives for implementing various aggregation functions: histograms,
  percentiles, unique counts, etc.
- primitives for implementing GROUP BY, ORDER BY, sampling, loading, storing,
  merging intermediate results, formatting query output, etc.

At some point, this code was used for powering parallel & distributed analytic
database and ETL pipline for 10TB+ of telemetry data per day.

There are many other query engines / runtimes out there. This one focused on
being very compact, flexible, and performant. It was deliverying query speeds
exceeding 2GB/second per core and optimized for sequential file IO.

The query engine implementation was based on linking the runtime with C code
generated by the query compiler (not included with this repo).


## Source code

- [lib](./lib) - The main library code. The contents should be self explanatory.
  The entry point for the library is `lib/wam_query.c`
- [util](./util) -- Miscellaneous utilities.


## Usage

To build:

```
cd lib && make
```

To link with the generated C query code (`query.c`):

```
# debug mode
cc -g -I . -DWAM_QUERY='query.c' lib/wam_query.c -lstdc++ -Llib -lwam


# optimized mode
cc -O3 -I . -DWAM_QUERY='query.c' lib/wam_query.c lib/libwam.o -lm -lstdc++
```


## Contributing

This project is read-only and not accepting contributions.

Feel free to clone. It is open-sourced under the Apache 2 license. see
[LICENSE](./LICENSE) file for details.
